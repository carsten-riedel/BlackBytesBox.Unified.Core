<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Class MainContext
 | BlackBytesBox.Unified.Core </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Class MainContext
 | BlackBytesBox.Unified.Core ">
    
      <link rel="shortcut icon" href="../favicon.ico">
      <link rel="stylesheet" href="../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../styles/docfx.css">
      <link rel="stylesheet" href="../styles/main.css">
      <meta property="docfx:navrel" content="../toc.json">
      <meta property="docfx:tocrel" content="toc.json">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="BlackBytesBox.Unified.Core">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>

                <ul class="nav level1 navbar-nav">
                      <li>
                          <a href="../api/BlackBytesBox.Unified.Core.Extensions.StringExtensions.html" title="API">API</a>
                      </li>
                </ul>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">

                  <ul class="nav level1">
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="BlackBytesBox.Unified.Core.Extensions.StringExtensions.html" title="BlackBytesBox.Unified.Core.Extensions.StringExtensions" class="">BlackBytesBox.Unified.Core.Extensions.StringExtensions</a>

                        <ul class="nav level2">
                          <li class="">
                            <a href="BlackBytesBox.Unified.Core.Extensions.StringExtensions.StringExtensions.html" title="StringExtensions" class="">StringExtensions</a>
                          </li>
                          <li class="">
                            <a href="BlackBytesBox.Unified.Core.Extensions.StringExtensions.ValidationsStringExtensions.html" title="ValidationsStringExtensions" class="">ValidationsStringExtensions</a>
                          </li>
                        </ul>
                    </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="BlackBytesBox.Unified.Core.Utilities.MainContext.html" title="BlackBytesBox.Unified.Core.Utilities.MainContext" class="">BlackBytesBox.Unified.Core.Utilities.MainContext</a>

                        <ul class="nav level2">
                          <li class="active">
                            <a href="BlackBytesBox.Unified.Core.Utilities.MainContext.MainContext.html" title="MainContext" class="active">MainContext</a>
                          </li>
                        </ul>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="BlackBytesBox.Unified.Core.Utilities.MainContext.MainContext">



  <h1 id="BlackBytesBox_Unified_Core_Utilities_MainContext_MainContext" data-uid="BlackBytesBox.Unified.Core.Utilities.MainContext.MainContext" class="text-break">Class MainContext
</h1>
  <div class="markdown level0 summary"><p>Provides utility methods for managing the application's execution context, primarily for use within the Program.Main entry point.</p>
</div>
  <div class="markdown level0 conceptual"></div>
  <div class="inheritance">
    <h5>Inheritance</h5>
    <div class="level0"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
    <div class="level1"><span class="xref">MainContext</span></div>
  </div>
  <div class="inheritedMembers">
    <h5>Inherited Members</h5>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </div>
  <h6><strong>Namespace</strong>: <a class="xref" href="BlackBytesBox.html">BlackBytesBox</a>.<a class="xref" href="BlackBytesBox.Unified.html">Unified</a>.<a class="xref" href="BlackBytesBox.Unified.Core.html">Core</a>.<a class="xref" href="BlackBytesBox.Unified.Core.Utilities.html">Utilities</a>.<a class="xref" href="BlackBytesBox.Unified.Core.Utilities.MainContext.html">MainContext</a></h6>
  <h6><strong>Assembly</strong>: BlackBytesBox.Unified.Core.dll</h6>
  <h5 id="BlackBytesBox_Unified_Core_Utilities_MainContext_MainContext_syntax">Syntax</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static class MainContext</code></pre>
  </div>
  <h3 id="methods">Methods
</h3>
  <span class="small pull-right mobile-hide">
    <span class="divider">|</span>
    <a href="https://github.com/carsten-riedel/BlackBytesBox.Unified.Core/new/feature/init/apiSpec/new?filename=BlackBytesBox_Unified_Core_Utilities_MainContext_MainContext_EnsureSingleInstance_System_Action_System_Boolean_.md&amp;value=---%0Auid%3A%20BlackBytesBox.Unified.Core.Utilities.MainContext.MainContext.EnsureSingleInstance(System.Action%2CSystem.Boolean)%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Edit this page</a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/carsten-riedel/BlackBytesBox.Unified.Core/blob/feature/init/source/BlackBytesBox.Unified.Core/BlackBytesBox.Unified.Core/Utilities/MainContext/EnsureSingleInstance.cs/#L41">View Source</a>
  </span>
  <a id="BlackBytesBox_Unified_Core_Utilities_MainContext_MainContext_EnsureSingleInstance_" data-uid="BlackBytesBox.Unified.Core.Utilities.MainContext.MainContext.EnsureSingleInstance*"></a>
  <h4 id="BlackBytesBox_Unified_Core_Utilities_MainContext_MainContext_EnsureSingleInstance_System_Action_System_Boolean_" data-uid="BlackBytesBox.Unified.Core.Utilities.MainContext.MainContext.EnsureSingleInstance(System.Action,System.Boolean)">EnsureSingleInstance(Action, bool)</h4>
  <div class="markdown level1 summary"><p>Ensures that only a single instance of the application is running.
If another instance is detected, the specified duplicate instance action is executed,
and optionally the application is terminated.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="declaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static void EnsureSingleInstance(Action duplicateInstanceAction, bool exitOnDuplicate = true)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.action">Action</a></td>
        <td><span class="parametername">duplicateInstanceAction</span></td>
        <td><p>An <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.action">Action</a> to execute if a duplicate instance is detected.
This action can be used to notify the user or log the occurrence of a duplicate instance.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></td>
        <td><span class="parametername">exitOnDuplicate</span></td>
        <td><p>A boolean value indicating whether to terminate the application when a duplicate instance is detected. Defaults to true.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="BlackBytesBox_Unified_Core_Utilities_MainContext_MainContext_EnsureSingleInstance_System_Action_System_Boolean__remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>The method attempts to create a named <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.threading.mutex">Mutex</a> using the application's entry assembly name.
If the mutex already exists, it indicates that another instance of the application is running.</p>
</div>
  <h5 id="BlackBytesBox_Unified_Core_Utilities_MainContext_MainContext_EnsureSingleInstance_System_Action_System_Boolean__examples">Examples</h5>
  <pre><code class="lang-csharp">// Ensure single instance; if a duplicate is detected, notify the user and exit.
MainContext.EnsureSingleInstance(() =&gt; Console.WriteLine("Another instance is already running."));</code></pre>

  <span class="small pull-right mobile-hide">
    <span class="divider">|</span>
    <a href="https://github.com/carsten-riedel/BlackBytesBox.Unified.Core/new/feature/init/apiSpec/new?filename=BlackBytesBox_Unified_Core_Utilities_MainContext_MainContext_TryGetOrCreateAppNameDirectory_System_String___System_Boolean_System_String___System_Boolean_.md&amp;value=---%0Auid%3A%20BlackBytesBox.Unified.Core.Utilities.MainContext.MainContext.TryGetOrCreateAppNameDirectory(System.String%5B%5D%2CSystem.Boolean%2CSystem.String%5B%5D%2CSystem.Boolean)%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Edit this page</a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/carsten-riedel/BlackBytesBox.Unified.Core/blob/feature/init/source/BlackBytesBox.Unified.Core/BlackBytesBox.Unified.Core/Utilities/MainContext/TryGetOrCreateAppNameDirectory.cs/#L39">View Source</a>
  </span>
  <a id="BlackBytesBox_Unified_Core_Utilities_MainContext_MainContext_TryGetOrCreateAppNameDirectory_" data-uid="BlackBytesBox.Unified.Core.Utilities.MainContext.MainContext.TryGetOrCreateAppNameDirectory*"></a>
  <h4 id="BlackBytesBox_Unified_Core_Utilities_MainContext_MainContext_TryGetOrCreateAppNameDirectory_System_String___System_Boolean_System_String___System_Boolean_" data-uid="BlackBytesBox.Unified.Core.Utilities.MainContext.MainContext.TryGetOrCreateAppNameDirectory(System.String[],System.Boolean,System.String[],System.Boolean)">TryGetOrCreateAppNameDirectory(string[]?, bool, string[]?, bool)</h4>
  <div class="markdown level1 summary"><p>Retrieves or creates a directory based on the application's name, which is derived from the primary file location.
Optionally, a unique identifier is appended to the directory name when the <code class="paramref">useStartupAppLocation</code> flag is set to true.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="declaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static DirectoryInfo? TryGetOrCreateAppNameDirectory(string[]? candidateBaseDirectories = null, bool useStartupAppLocation = false, string[]? subdirectoriesToEnsure = null, bool throwIfFails = false)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>[]</td>
        <td><span class="parametername">candidateBaseDirectories</span></td>
        <td><p>An optional array of candidate base directories where the application directory should be searched for or created.
If not provided, a default set of system directories will be used.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></td>
        <td><span class="parametername">useStartupAppLocation</span></td>
        <td><p>When set to true, appends a unique identifier (derived from the primary file location) to the application directory name.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>[]</td>
        <td><span class="parametername">subdirectoriesToEnsure</span></td>
        <td><p>An optional array of subdirectory names that should be ensured (created if missing) within the application directory.</p>
</td>
      </tr>
      <tr>
        <td><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></td>
        <td><span class="parametername">throwIfFails</span></td>
        <td><p>Indicates whether an exception should be thrown if the operation to retrieve or create the directory fails.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.io.directoryinfo">DirectoryInfo</a></td>
        <td><p>A <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.io.directoryinfo">DirectoryInfo</a> object representing the application directory if successfully retrieved or created; otherwise, null.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="BlackBytesBox_Unified_Core_Utilities_MainContext_MainContext_TryGetOrCreateAppNameDirectory_System_String___System_Boolean_System_String___System_Boolean__examples">Examples</h5>
  <pre><code class="lang-csharp">// Retrieve or create the application directory using default settings.
var configDirectory = MainContext.TryGetOrCreateAppNameDirectory();</code></pre>

  <span class="small pull-right mobile-hide">
    <span class="divider">|</span>
    <a href="https://github.com/carsten-riedel/BlackBytesBox.Unified.Core/new/feature/init/apiSpec/new?filename=BlackBytesBox_Unified_Core_Utilities_MainContext_MainContext_TryGetPrimaryFileLocation.md&amp;value=---%0Auid%3A%20BlackBytesBox.Unified.Core.Utilities.MainContext.MainContext.TryGetPrimaryFileLocation%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Edit this page</a>
  </span>
  <span class="small pull-right mobile-hide">
    <a href="https://github.com/carsten-riedel/BlackBytesBox.Unified.Core/blob/feature/init/source/BlackBytesBox.Unified.Core/BlackBytesBox.Unified.Core/Utilities/MainContext/TryGetPrimaryFileLocation.cs/#L28">View Source</a>
  </span>
  <a id="BlackBytesBox_Unified_Core_Utilities_MainContext_MainContext_TryGetPrimaryFileLocation_" data-uid="BlackBytesBox.Unified.Core.Utilities.MainContext.MainContext.TryGetPrimaryFileLocation*"></a>
  <h4 id="BlackBytesBox_Unified_Core_Utilities_MainContext_MainContext_TryGetPrimaryFileLocation" data-uid="BlackBytesBox.Unified.Core.Utilities.MainContext.MainContext.TryGetPrimaryFileLocation">TryGetPrimaryFileLocation()</h4>
  <div class="markdown level1 summary"><p>Attempts to identify and return the primary file location of the currently executing application.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="declaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static string? TryGetPrimaryFileLocation()</code></pre>
  </div>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></td>
        <td><p>The file path of the main module if its name matches the domain, or the location of the
entry or calling assembly. Returns null if none of these locations can be determined.</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 id="BlackBytesBox_Unified_Core_Utilities_MainContext_MainContext_TryGetPrimaryFileLocation_remarks">Remarks</h5>
  <div class="markdown level1 remarks"><p>This method first tries to match the main executable's name with the current domain name.
If no match is found, it attempts to retrieve the location from the entry assembly or,
if that is not available, from the calling assembly. This method is useful for applications
that need to determine the path of the currently running executable or assembly.</p>
</div>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/carsten-riedel/BlackBytesBox.Unified.Core/new/feature/init/apiSpec/new?filename=BlackBytesBox_Unified_Core_Utilities_MainContext_MainContext.md&amp;value=---%0Auid%3A%20BlackBytesBox.Unified.Core.Utilities.MainContext.MainContext%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A" class="contribution-link">Edit this page</a>
                  </li>
                  <li>
                    <a href="https://github.com/carsten-riedel/BlackBytesBox.Unified.Core/blob/feature/init/source/BlackBytesBox.Unified.Core/BlackBytesBox.Unified.Core/Utilities/MainContext/TryGetPrimaryFileLocation.cs/#L11" class="contribution-link">View Source</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      <pre></pre>
      
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
